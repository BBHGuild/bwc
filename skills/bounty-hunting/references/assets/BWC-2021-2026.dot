digraph BWC_Evolution_2021_2026 {
    graph [rankdir=LR, splines=curved, bgcolor="white", fontname="Arial", ranksep=1.5, nodesep=0.3, label="BWC Top 11 (Blockchain Weakness Classification)", labelloc="t", fontsize=20];
    node [shape=none, fontname="Arial", fontsize=12];
    edge [penwidth=3, arrowsize=0.8, opacity=0.8];

    // --- CLUSTERS & NODES ---

    // 2021
    subgraph cluster_2021 {
        label = "2021 - 0 Incidents";
        style = "rounded,filled";
        fillcolor = "#f8f9fa";
        color = "#e9ecef";

        rank2021 [label=<
            <TABLE BORDER="0" CELLBORDER="0" CELLSPACING="0" CELLPADDING="4">
                <TR><TD ALIGN="LEFT" PORT="p1"><FONT COLOR="#D7263D"><B>#1: Ecosystem &amp; Off-Chain</B></FONT></TD><TD ALIGN="RIGHT"><B>$∞</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p2"><FONT COLOR="#4A148C"><B>#2: Smart Contract Logic</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p3"><FONT COLOR="#827717"><B>#3: Economic &amp; Game-Theoretic</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p4"><FONT COLOR="#00695C"><B>#4: Input &amp; Data Validation</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p5"><FONT COLOR="#E65100"><B>#5: Access Control</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p6"><FONT COLOR="#880E4F"><B>#6: Arithmetic &amp; Numeric</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p7"><FONT COLOR="#5D4037"><B>#7: Low-Level &amp; EVM</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p8"><FONT COLOR="#616161"><B>#8: Denial of Service</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p9"><FONT COLOR="#EF6C00"><B>#9: Emerging Technology</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p10"><FONT COLOR="#B71C1C"><B>#10: Network &amp; Consensus</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p11"><FONT COLOR="#0D47A1"><B>#11: Privacy &amp; Regulatory</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT"><B>Total Value Lost</B></TD><TD ALIGN="RIGHT"><B>$0</B></TD></TR>
            </TABLE>
        >];
    }

    // 2022
    subgraph cluster_2022 {
        label = "2022 - 0 Incidents";
        style = "rounded,filled";
        fillcolor = "#f8f9fa";
        color = "#e9ecef";

        rank2022 [label=<
            <TABLE BORDER="0" CELLBORDER="0" CELLSPACING="0" CELLPADDING="4">
                <TR><TD ALIGN="LEFT" PORT="p1"><FONT COLOR="#D7263D"><B>#1: Ecosystem &amp; Off-Chain</B></FONT></TD><TD ALIGN="RIGHT"><B>$∞</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p2"><FONT COLOR="#4A148C"><B>#2: Smart Contract Logic</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p3"><FONT COLOR="#827717"><B>#3: Economic &amp; Game-Theoretic</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p4"><FONT COLOR="#00695C"><B>#4: Input &amp; Data Validation</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p5"><FONT COLOR="#E65100"><B>#5: Access Control</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p6"><FONT COLOR="#880E4F"><B>#6: Arithmetic &amp; Numeric</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p7"><FONT COLOR="#5D4037"><B>#7: Low-Level &amp; EVM</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p8"><FONT COLOR="#616161"><B>#8: Denial of Service</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p9"><FONT COLOR="#EF6C00"><B>#9: Emerging Technology</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p10"><FONT COLOR="#B71C1C"><B>#10: Network &amp; Consensus</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p11"><FONT COLOR="#0D47A1"><B>#11: Privacy &amp; Regulatory</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT"><B>Total Value Lost</B></TD><TD ALIGN="RIGHT"><B>$0</B></TD></TR>
            </TABLE>
        >];
    }

    // 2023
    subgraph cluster_2023 {
        label = "2023 - 3 Incidents";
        style = "rounded,filled";
        fillcolor = "#f8f9fa";
        color = "#e9ecef";

        rank2023 [label=<
            <TABLE BORDER="0" CELLBORDER="0" CELLSPACING="0" CELLPADDING="4">
                <TR><TD ALIGN="LEFT" PORT="p1"><FONT COLOR="#D7263D"><B>#1: Ecosystem &amp; Off-Chain</B></FONT></TD><TD ALIGN="RIGHT"><B>$∞</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p2"><FONT COLOR="#00695C"><B>#2: Input &amp; Data Validation</B></FONT></TD><TD ALIGN="RIGHT">$212K</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p3"><FONT COLOR="#4A148C"><B>#3: Smart Contract Logic</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p4"><FONT COLOR="#827717"><B>#4: Economic &amp; Game-Theoretic</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p5"><FONT COLOR="#E65100"><B>#5: Access Control</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p6"><FONT COLOR="#880E4F"><B>#6: Arithmetic &amp; Numeric</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p7"><FONT COLOR="#5D4037"><B>#7: Low-Level &amp; EVM</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p8"><FONT COLOR="#616161"><B>#8: Denial of Service</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p9"><FONT COLOR="#EF6C00"><B>#9: Emerging Technology</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p10"><FONT COLOR="#B71C1C"><B>#10: Network &amp; Consensus</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p11"><FONT COLOR="#0D47A1"><B>#11: Privacy &amp; Regulatory</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT"><B>Total Value Lost</B></TD><TD ALIGN="RIGHT"><B>$212K</B></TD></TR>
            </TABLE>
        >];
    }

    // 2024
    subgraph cluster_2024 {
        label = "2024 - 61 Incidents";
        style = "rounded,filled";
        fillcolor = "#f8f9fa";
        color = "#e9ecef";

        rank2024 [label=<
            <TABLE BORDER="0" CELLBORDER="0" CELLSPACING="0" CELLPADDING="4">
                <TR><TD ALIGN="LEFT" PORT="p1"><FONT COLOR="#D7263D"><B>#1: Ecosystem &amp; Off-Chain</B></FONT></TD><TD ALIGN="RIGHT"><B>$∞</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p2"><FONT COLOR="#E65100"><B>#2: Access Control</B></FONT></TD><TD ALIGN="RIGHT">$74.2M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p3"><FONT COLOR="#4A148C"><B>#3: Smart Contract Logic</B></FONT></TD><TD ALIGN="RIGHT">$47.2M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p4"><FONT COLOR="#827717"><B>#4: Economic &amp; Game-Theoretic</B></FONT></TD><TD ALIGN="RIGHT">$28.1M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p5"><FONT COLOR="#880E4F"><B>#5: Arithmetic &amp; Numeric</B></FONT></TD><TD ALIGN="RIGHT">$10.3M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p6"><FONT COLOR="#00695C"><B>#6: Input &amp; Data Validation</B></FONT></TD><TD ALIGN="RIGHT">$8.9M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p7"><FONT COLOR="#5D4037"><B>#7: Low-Level &amp; EVM</B></FONT></TD><TD ALIGN="RIGHT">$1.0M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p8"><FONT COLOR="#616161"><B>#8: Denial of Service</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p9"><FONT COLOR="#EF6C00"><B>#9: Emerging Technology</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p10"><FONT COLOR="#B71C1C"><B>#10: Network &amp; Consensus</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p11"><FONT COLOR="#0D47A1"><B>#11: Privacy &amp; Regulatory</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT"><B>Total Value Lost</B></TD><TD ALIGN="RIGHT"><B>$169.7M</B></TD></TR>
            </TABLE>
        >];
    }

    // 2025
    subgraph cluster_2025 {
        label = "2025 - 49 Incidents";
        style = "rounded,filled";
        fillcolor = "#f8f9fa";
        color = "#e9ecef";

        rank2025 [label=<
            <TABLE BORDER="0" CELLBORDER="0" CELLSPACING="0" CELLPADDING="4">
                <TR><TD ALIGN="LEFT" PORT="p1"><FONT COLOR="#D7263D"><B>#1: Ecosystem &amp; Off-Chain</B></FONT></TD><TD ALIGN="RIGHT"><B>$∞</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p2"><FONT COLOR="#880E4F"><B>#2: Arithmetic &amp; Numeric</B></FONT></TD><TD ALIGN="RIGHT">$130.8M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p3"><FONT COLOR="#827717"><B>#3: Economic &amp; Game-Theoretic</B></FONT></TD><TD ALIGN="RIGHT">$77.8M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p4"><FONT COLOR="#4A148C"><B>#4: Smart Contract Logic</B></FONT></TD><TD ALIGN="RIGHT">$77.0M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p5"><FONT COLOR="#E65100"><B>#5: Access Control</B></FONT></TD><TD ALIGN="RIGHT">$18.3M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p6"><FONT COLOR="#5D4037"><B>#6: Low-Level &amp; EVM</B></FONT></TD><TD ALIGN="RIGHT">$10.0M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p7"><FONT COLOR="#00695C"><B>#7: Input &amp; Data Validation</B></FONT></TD><TD ALIGN="RIGHT">$9.0M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p8"><FONT COLOR="#616161"><B>#8: Denial of Service</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p9"><FONT COLOR="#EF6C00"><B>#9: Emerging Technology</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p10"><FONT COLOR="#B71C1C"><B>#10: Network &amp; Consensus</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p11"><FONT COLOR="#0D47A1"><B>#11: Privacy &amp; Regulatory</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT"><B>Total Value Lost</B></TD><TD ALIGN="RIGHT"><B>$322.9M</B></TD></TR>
            </TABLE>
        >];
    }

    // 2026
    subgraph cluster_2026 {
        label = "2026 (YTD) - 14 Incidents";
        style = "rounded,filled";
        fillcolor = "#f8f9fa";
        color = "#e9ecef";

        rank2026 [label=<
            <TABLE BORDER="0" CELLBORDER="0" CELLSPACING="0" CELLPADDING="4">
                <TR><TD ALIGN="LEFT" PORT="p1"><FONT COLOR="#D7263D"><B>#1: Ecosystem &amp; Off-Chain</B></FONT></TD><TD ALIGN="RIGHT"><B>$∞</B></TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p2"><FONT COLOR="#880E4F"><B>#2: Arithmetic &amp; Numeric</B></FONT></TD><TD ALIGN="RIGHT">$26.6M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p3"><FONT COLOR="#E65100"><B>#3: Access Control</B></FONT></TD><TD ALIGN="RIGHT">$16.8M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p4"><FONT COLOR="#4A148C"><B>#4: Smart Contract Logic</B></FONT></TD><TD ALIGN="RIGHT">$8.7M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p5"><FONT COLOR="#827717"><B>#5: Economic &amp; Game-Theoretic</B></FONT></TD><TD ALIGN="RIGHT">$8.0M</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p6"><FONT COLOR="#B71C1C"><B>#6: Network &amp; Consensus</B></FONT></TD><TD ALIGN="RIGHT">$336K</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p7"><FONT COLOR="#00695C"><B>#7: Input &amp; Data Validation</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p8"><FONT COLOR="#5D4037"><B>#8: Low-Level &amp; EVM</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p9"><FONT COLOR="#616161"><B>#9: Denial of Service</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p10"><FONT COLOR="#EF6C00"><B>#10: Emerging Technology</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT" PORT="p11"><FONT COLOR="#0D47A1"><B>#11: Privacy &amp; Regulatory</B></FONT></TD><TD ALIGN="RIGHT">$0</TD></TR>
                <TR><TD ALIGN="LEFT"><B>Total Value Lost</B></TD><TD ALIGN="RIGHT"><B>$60.4M</B></TD></TR>
            </TABLE>
        >];
    }

    last_update [label="Last Update:\nFeb 02, 2026", shape=note, style=filled, fillcolor="#fff3cd", fontcolor="#000000", fontsize=10, margin=0.2];

    // BWC 1: Ecosystem & Offchain
    rank2021:p1 -> rank2022:p1 [color="#D7263D"];
    rank2022:p1 -> rank2023:p1 [color="#D7263D"];
    rank2023:p1 -> rank2024:p1 [color="#D7263D"];
    rank2024:p1 -> rank2025:p1 [color="#D7263D"];
    rank2025:p1 -> rank2026:p1 [color="#D7263D"];

    // BWC 3: SmartContract Logic
    rank2021:p2 -> rank2022:p2 [color="#4A148C"];
    rank2022:p2 -> rank2023:p3 [color="#4A148C"];
    rank2023:p3 -> rank2024:p3 [color="#4A148C"];
    rank2024:p3 -> rank2025:p4 [color="#4A148C"];
    rank2025:p4 -> rank2026:p4 [color="#4A148C"];

    // BWC 2: Access Control
    rank2021:p5 -> rank2022:p5 [color="#E65100"];
    rank2022:p5 -> rank2023:p5 [color="#E65100"];
    rank2023:p5 -> rank2024:p2 [color="#E65100"];
    rank2024:p2 -> rank2025:p5 [color="#E65100"];
    rank2025:p5 -> rank2026:p3 [color="#E65100"];

    // BWC 5: Economic & Game Theory
    rank2021:p3 -> rank2022:p3 [color="#827717"];
    rank2022:p3 -> rank2023:p4 [color="#827717"];
    rank2023:p4 -> rank2024:p4 [color="#827717"];
    rank2024:p4 -> rank2025:p3 [color="#827717"];
    rank2025:p3 -> rank2026:p5 [color="#827717"];

    // BWC 4: Input & Data Validation
    rank2021:p4 -> rank2022:p4 [color="#00695C"];
    rank2022:p4 -> rank2023:p2 [color="#00695C"];
    rank2023:p2 -> rank2024:p6 [color="#00695C"];
    rank2024:p6 -> rank2025:p7 [color="#00695C"];
    rank2025:p7 -> rank2026:p7 [color="#00695C"];

    // BWC 6: Arithimetic & Numeric
    rank2021:p6 -> rank2022:p6 [color="#880E4F"];
    rank2022:p6 -> rank2023:p6 [color="#880E4F"];
    rank2023:p6 -> rank2024:p5 [color="#880E4F"];
    rank2024:p5 -> rank2025:p2 [color="#880E4F"];
    rank2025:p2 -> rank2026:p2 [color="#880E4F"];

    // BWC 7: Low levl & EVM
    rank2021:p7 -> rank2022:p7 [color="#5D4037"];
    rank2022:p7 -> rank2023:p7 [color="#5D4037"];
    rank2023:p7 -> rank2024:p7 [color="#5D4037"];
    rank2024:p7 -> rank2025:p6 [color="#5D4037"];
    rank2025:p6 -> rank2026:p8 [color="#5D4037"];

    // BWC 8: #616161 (Gray)
    rank2021:p8 -> rank2022:p8 [color="#616161"];
    rank2022:p8 -> rank2023:p8 [color="#616161"];
    rank2023:p8 -> rank2024:p8 [color="#616161"];
    rank2024:p8 -> rank2025:p8 [color="#616161"];
    rank2025:p8 -> rank2026:p9 [color="#616161"];

    // BWC 9: #EF6C00 (Amber)
    edge [style=dashed]; // Switch style for dashed lines
    rank2021:p9 -> rank2022:p9 [color="#EF6C00"];
    rank2022:p9 -> rank2023:p9 [color="#EF6C00"];
    rank2023:p9 -> rank2024:p9 [color="#EF6C00"];
    rank2024:p9 -> rank2025:p9 [color="#EF6C00"];
    rank2025:p9 -> rank2026:p10 [color="#EF6C00"];

    // BWC 10: #B71C1C (Dark Red)
    rank2021:p10 -> rank2022:p10 [color="#B71C1C"];
    rank2022:p10 -> rank2023:p10 [color="#B71C1C"];
    rank2023:p10 -> rank2024:p10 [color="#B71C1C"];
    rank2024:p10 -> rank2025:p10 [color="#B71C1C"];
    rank2025:p10 -> rank2026:p6 [color="#B71C1C"];

    // BWC 11: #0D47A1 (Blue)
    edge [style=solid]; // Reset to solid
    rank2021:p11 -> rank2022:p11 [color="#0D47A1"];
    rank2022:p11 -> rank2023:p11 [color="#0D47A1"];
    rank2023:p11 -> rank2024:p11 [color="#0D47A1"];
    rank2024:p11 -> rank2025:p11 [color="#0D47A1"];
    rank2025:p11 -> rank2026:p11 [color="#0D47A1"];
}
